{% extends "base.html" %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h3 class="m-0">Dashboard</h3>
  <a class="btn btn-outline-primary btn-sm" href="{{ url_for('upload') }}">Upload New File</a>
</div>

<div class="row g-3">
  {% for key, val in kpis.items() %}
  <div class="col-12 col-sm-6 col-lg-3">
    <div class="card kpi-card p-3">
      <div class="text-muted small text-uppercase">{{ key }}</div>
      <div class="fs-4 fw-semibold">{{ val }}</div>
    </div>
  </div>
  {% endfor %}
</div>

<div class="card p-3 mt-4">
  <div class="d-flex align-items-center justify-content-between">
    <h5 class="m-0">Preview (Top 20 rows)</h5>
    <span class="text-muted small">Columns: {{ columns|length }}</span>
  </div>

  <div class="table-responsive mt-3">
    <table class="table table-sm table-striped align-middle">
      <thead>
        <tr>
          {% for c in columns %}<th class="text-nowrap">{{ c }}</th>{% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in preview %}
        <tr>
          {% for c in columns %}<td class="text-nowrap">{{ row.get(c, "") }}</td>{% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
